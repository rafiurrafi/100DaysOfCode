(window.feefoJsonp=window.feefoJsonp||[]).push([[0],{103:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(36)),o=r(i(10)),s=r(i(60)),a=r(i(430));function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){},d=new n.default(a.default),f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=(t="function"==typeof t?t:u)();this.configResolver=t,this.feefoParameters="include",this.hasMore=!0,this.loading=!1,this.mediaItems=[],this.merchantSlug=i.merchantSlug,this.origin=o.default.getOrigin(),this.reviewItems=[],this.sku=this._getSku(i),this.submerchant=o.default.getSubmerchantMedia(),this.summary={},this.whitelistedWidgets=["mediaIntegration"],this._setMediaConfig()}var t,i,n;return t=e,n=[{key:"fetchFilters",value:function(e){var t="/media/reviews/filters/".concat(e.config.merchantSlug);return new Promise(function(e){d.get(t,{},function(t,i){e(s.default.mediaFilters(i.data.data.filters))})})}}],(i=[{key:"fetchGallery",value:function(e){return this.disabled?Promise.resolve([]):"service"===this.type?this._fetchGalleryService(e):"product"===this.type?this._fetchGalleryProduct(e):void 0}},{key:"fetchReviews",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(this.hasMore=!0,this.reviewItems=[]),this.disabled||!this.hasMore?Promise.resolve([]):this._fetchReviewsDistinct(e)}},{key:"_canShowMedia",value:function(e){return!e&&!!this.mediaItems.length}},{key:"_fetchGalleryProduct",value:function(e){var t=this;if(this.promiseGalleryProduct)return this.promiseGalleryProduct;var i="/media/gallery/".concat(this.merchantSlug,"/sku/").concat(this.sku);return Object.assign(e,{feefo_parameters:this.feefoParameters,origin:this.origin,submerchant:this.submerchant}),this.promiseGalleryProduct=new Promise(function(n){var o={query:e};d.get(i,o,function(e,i){var o=t.configResolver();t.mediaItems=s.default.mediaItems(o,i.data.resources),t._setMediaConfig(),n(t.mediaItems)})}),this.promiseGalleryProduct}},{key:"_fetchGalleryService",value:function(e){var t=this;if(this.promiseGalleryService)return this.promiseGalleryService;var i="/media/gallery/".concat(this.merchantSlug,"/service");return Object.assign(e,{feefo_parameters:this.feefoParameters,origin:this.origin,submerchant:this.submerchant}),this.promiseGalleryService=new Promise(function(n){var o={query:e};d.get(i,o,function(e,i){var o=t.configResolver();t.mediaItems=s.default.mediaItems(o,i.data.resources),t._setMediaConfig(),n(t.mediaItems)})}),this.promiseGalleryService}},{key:"_fetchReviewsDistinct",value:function(e){var t=this;return new Promise(function(i){var n={data:Object.assign(e,{slug:t.merchantSlug}),type:"json"};t.loading=!0,d.post("/media/reviews",n,function(e,n){var o=t.configResolver(),a=n.data.data,r=s.default.mediaReviewItems(o,a.summary,a.reviews);t.hasMore=a.more,t.loading=!1,t.reviewItems=t.reviewItems.concat(r),t.summary=a.summary,t._setMediaConfig(),i(t.summary)})})}},{key:"_getModeString",value:function(){return this.configResolver().isModeProduct?"product":"service"}},{key:"_getSku",value:function(){var e=this.configResolver();return e.parentProductSku?e.parentProductSku:e.productSku?e.productSku:void 0}},{key:"_getWidgetName",value:function(){var e=this.configResolver();switch(this._getWidgetType()){case"lightbox":return e.isModeProduct?"productWidget":"serviceWidget";case"onPage":return e.isModeProduct?"productOnPage":"serviceOnPage";case"floating":return"reviewsWidget";case"facebook":return"facebookWidget";case"media-integration":return"mediaIntegration";case"carousel":return"serviceCarouselWidget";default:throw new Error("Unknown Widget type")}}},{key:"_getWidgetType",value:function(){var e=this.configResolver();return e.isTypeOnpage?"onPage":e.isTypeLightbox?"lightbox":e.isTypeFloating?"floating":e.isTypeFacebook?"facebook":e.isTypeMediaIntegration?"media-integration":e.isTypeCarousel?"carousel":void 0}},{key:"_isDisabled",value:function(){var e,t=this.configResolver().preferences,i=this._getWidgetName(),n=-1!==this.whitelistedWidgets.indexOf(i),o=(e="serviceCarouselWidget"===i?"serviceWidget":i,!!(t&&t[e]&&t[e].mediaPanel));return!n&&!o}},{key:"_setMediaConfig",value:function(){this.type=this._getModeString(),this.disabled=this._isDisabled(),this.show=this._canShowMedia(this.disabled)}}])&&c(t.prototype,i),n&&c(t,n),e}();t.default=f},146:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var n=f(i(10)),o=f(i(431)),s=i(48),a=f(s),r=f(i(175)),c=i(3),u=f(i(17)),d=i(9);function f(e){return e&&e.__esModule?e:{default:e}}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){g(e,t,i[t])})}return e}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(){var e=this;this.root.tagName!==d.FACEBOOK.tag.toUpperCase()&&(this.trackerPayload={},this.config=(0,c.getConfig)(),this.on("mount",function(){e.root.tagName!==d.PRODUCT_STARS.tag.toUpperCase()&&(e.opts.isModeProduct?r.default.trackMounted(e.root.tagName,e.getProductSKU(),e.getParentProductSku()):r.default.trackMounted(e.root.tagName))}),this.on("unmount",function(){e.root.removeEventListener("click",e.trackClickDebounced)}))}Object.assign(h.prototype,{initEventInstance:function(){var e=this;this.reviewStats={},this.eventsInstance=u.default.getInstance(this.widgetReference),this.eventsInstance.on("fetched-widget-data",function(t){var i=t.reviewCount,o=t.averageRating;e.reviewStats.avgRating=o,e.reviewStats.reviewCount=i,e.trackClickDebounced=n.default.debounce(e.trackClick.bind(e),(0,c.getConfig)().trackingDebouncePeriod),e.root.addEventListener("click",e.trackClickDebounced),e._startTrackWidgetVisibility(),r.default.trackReviewsLoaded(e.root.tagName,e.reviewStats)},!0)},getProductSKU:function(){if(this.opts.isModeProduct)return!this.config.productSku&&this.config.parentProductSku?void 0:this.config.productSku},getParentProductSku:function(){if(this.opts.isModeProduct)return!this.config.productSku&&this.config.parentProductSku?this.config.parentProductSku:void 0},updateTrackerPayload:function(e){this.trackerPayload=l({},this.trackerPayload,e)},trackClick:function(e){if(0!==(0,c.getConfig)().reviewCount){var t=o.default.map(function(e){return e.className}),i=e.target.closest(t.join(","))||e.target,n=o.default.find(function(e){return i.matches(e.className)})||{name:"General"};a.default.trackEvent(s.FeefoEventTracker.EVENTS.CLICKED,l({widgetInstance:this.root.tagName,context:{targetElement:i.tagName,targetClass:n.className||i.className,clickType:n.name},reviewData:this.reviewStats},this.trackerPayload))}},_startTrackWidgetVisibility:function(){var e=this,t=n.default.isPartlyInViewport(this.root),i=function(){return setTimeout(function(){var i;(i=n.default.isPartlyInViewport(e.root))!==t&&(e._trackWidgetViewedEvent(),t=i)},50)};this._trackWidgetViewedEvent=n.default.trackWidgetViewedEvent(this.root,function(){window.removeEventListener("resize",e._trackWidgetViewedEventDebounced),window.removeEventListener("scroll",e._trackWidgetViewedEventDebounced),document.removeEventListener("click",i)},this.reviewStats),this._trackWidgetViewedEventDebounced=n.default.debounce(this._trackWidgetViewedEvent.bind(this),100),window.addEventListener("resize",this._trackWidgetViewedEventDebounced),window.addEventListener("scroll",this._trackWidgetViewedEventDebounced),document.addEventListener("click",i),this._trackWidgetViewedEvent()}})},17:function(e,t,i){"use strict";var n=i(16),o=i(10);e.exports=function(){var e={};function t(e){e=e||"init";var t={};return t.broadcast=function(e,t){if(this.data[e]=void 0!==t?t:null,!(this.observables[e]instanceof Array&&this.observables[e].length))return;this.logger.debug('Broadcasting "'+e+'": ',this.data[e]),this.observables[e].forEach(function(t){i.bind(this)(t,e)}.bind(this))}.bind(t),t.data={},t.key=e,t.listen=function(e){e.eventPromises=[],e.on("unmount",function(){Array.isArray(e.eventPromises)&&(e.eventPromises.forEach(function(e){e()}),e.eventPromises=[])})}.bind(t),t.logger=new n("events-"+e),t.observables={},t.off=s.bind(t),t.on=function(e,t,n){var a={handler:t,name:e,uuid:o.generateUUID()};this.observables[e]instanceof Array||(this.observables[e]=[]);void 0===this.data[e]&&(this.data[e]=null);this.observables[e].push(a),!0===n&&null!==this.data[e]&&i.bind(this)(a,e);return function(){s.bind(this)(a)}.bind(this)}.bind(t),t}function i(e,t){e.handler(this.data[t])}function s(e){var t=this.observables[e.name].indexOf(e);t>-1&&this.observables[e.name].splice(t,1)}return{getInstance:function(i){return void 0===e[i]&&(e[i]=t(i)),e[i]}}}()},2:function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=i(17),a=i(16);e.exports=function(){var e={};function t(e){e=e||"init";var t={};return t.data=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){o(e,t,i[t])})}return e}({},i(3).getConfig()),t.events=s.getInstance("config-"+e),t.get=function(e){return this.data.viewportClasses=this.viewportClasses(),e?this.data[e]:this.data}.bind(t),t.key=e,t.listen=function(e){var t=this.events.on("config-updated",function(){e.config=this.get(),e.update()}.bind(this));e.on("unmount",t),e.config=this.get()}.bind(t),t.logger=new a("config-"+e),t.mute=function(){clearTimeout(this.setPromise)}.bind(t),t.set=function(e,t,i){this.data[e]=t,clearTimeout(this.setPromise),!0===i?this.update():this.setPromise=setTimeout(this.update,100)}.bind(t),t.setPromise=null,t.viewportClasses=function(){var e=[];this.data.isViewportDesktop&&e.push("feefowidget-viewport-desktop");this.data.isViewportTabletLarge&&e.push("feefowidget-viewport-tablet-large");this.data.isViewportTablet&&e.push("feefowidget-viewport-tablet");this.data.isViewportMobileLarge&&e.push("feefowidget-viewport-mobile-large");this.data.isViewportMobile&&e.push("feefowidget-viewport-mobile");this.data.isViewportDesktopTablet&&e.push("feefowidget-viewport-desktop-tablet");this.data.isViewportTabletMobile&&e.push("feefowidget-viewport-tablet-mobile");return e.join(" ")}.bind(t),t.update=function(){if(null===this.events)return;clearTimeout(this.setPromise),this.events.broadcast("config-updated")}.bind(t),t}return{init:function(e){var i=t();return"object"===n(e)&&(e.config=i.get()),i},setReference:function(i,o){if(o||(o=this),!i)throw new Error("Reference key not passed.");return"object"===n(o)&&o.mute(),void 0===e[i]&&(e[i]=t(i)),e[i]}}}()},227:function(e,t){},228:function(e,t){e.exports='<div class="feefowidget-rating-container {config.viewportClasses}">\n  <div class="feefowidget-rating-wrapper { feefowidget-rating-wrapper--clicked: opts.isClicked }">\n    <div class="empty-stars">\n      <i\n        each="{[1,2,3,4,5]}"\n        riot-style="{getStarStyles()}"\n        class="feefowidget-star feefowidget-icon feefowidget-icon-star-o feefowidget-star-colour-{parent.opts.colour}">\n      </i>\n    </div>\n    <div\n      riot-style="width: { percentageRating + \'%\' }"\n      class="filled-stars">\n      <i\n        each="{[1,2,3,4,5]}"\n        riot-style="{getStarStyles()}"\n        class="feefowidget-star feefowidget-icon feefowidget-icon-star feefowidget-star-colour-{parent.opts.colour}">\n      </i>\n    </div>\n  </div>\n</div>\n'},28:function(e,t,i){"use strict";var n=i(1),o=a(i(2)),s=a(i(228));function a(e){return e&&e.__esModule?e:{default:e}}function r(){this.mixin(r.prototype),this.configInstance=o.default.init(this),this.percentageRating=0,this.widgetReference=null,this.on("mount",this._onMount),this.on("update",this._onUpdate)}i(227),Object.assign(r.prototype,{_calculatePercentageRating:function(e){return e>5&&(e=5),e<0&&(e=0),e/5*100},_onMount:function(){this.configInstance.listen(this),this.opts.rating=this.opts.rating?this.opts.rating:0,this.widgetReference=this.opts.widgetReference,this.update()},_onUpdate:function(){this.percentageRating=this.opts.rating?this._calculatePercentageRating(this.opts.rating):0},getStarStyles:function(){var e={};return this.opts.starSize&&(e["font-size"]=this.opts.starSize),this.opts.exactColor&&(e.color=this.opts.exactColor),e}}),(0,n.tag)("feefowidget-rating-stars",s.default,null,r)},430:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={data:{reviews:[],summary:{count:25,rating:4.2,merchant:{link:"https://ww2.feefo.com/en-GB/reviews/ohtest",name:"Test merchant"}},more:!0},status:"success"};Array.from(new Array(15)).forEach(function(e,t){var i={consumerName:"Ben Staker",feedbackType:t%3==0?"PRODUCT":"SERVICE",link:"https://ww2.feefo.com/en-GB/reviews/ohtest",location:"Marlow",mediaType:t%2==0?"IMAGE":"VIDEO",productName:"Feefo Test Product",resourceId:"59ddee68e4b0715b6cc10082",review:"asdasdasdasdasdasdasdasdasdda",score:4.2};"VIDEO"===i.mediaType&&(i.videoThumbnailUrl="https://view.vzaar.com/11783104/thumb",i.videoUrl="https://view.vzaar.com/11783104/video"),n.data.reviews.push(i)});var o={get:{"/media/reviews/filters/example-retail-merchant":{enabled:!1,response:{data:{filters:[{publicName:"Locale",values:["ar_GB","cs_GB","en","en_GB","en_ZM","es","fr_FR","hu_HU","nl","nl_GB","sv"],name:"Locale",type:"SALE"},{publicName:"Department",values:[],name:"Department",type:"PRODUCT"},{publicName:"",values:["Anton Slack","Jane","Joe Bloggs","John Smith","Operator 1","Operator 2","Operator 3","Operator 4","Operator 5"],name:"salesperson",type:"SALE"},{publicName:"Product Category",values:["1","3","Cameras","Canmore","Computers","Printers","Value New","bob"],name:"category",type:"PRODUCT"}]},status:"success"}}},post:{"/media/reviews":{enabled:!1,response:n}}};t.default=o},431:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=[{name:"Filter",className:".feefowidget-dropdown__btn-click-tracking"},{name:"Newest/Popular Tabs",className:".feefowidget-viewport-wrapper"},{name:"Link: Read more/less",className:".text-restriction-container"},{name:"Feefo ratings dropdown icon",className:".feefowidget-down-arrow"},{name:"Pagination item",className:".feefowidget-pagination-item"},{name:"Link: Read all Feefo verified reviews",className:".feefowidget-footer__b2c-reviews"},{name:"General",className:".feefowidget-product-stars"}]},72:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTouchDeviceData=function(){var e=Boolean("ontouchstart"in window||"undefined"!=typeof navigator&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints));o.default.setConfig("isTouchScreen",e)},t.setViewportData=function(e,t){var i=e.innerWidth,o=Boolean(i<=n.default.mobileMedium),s=Boolean(i<=n.default.mobileLarge),a=Boolean(i<=n.default.tablet),r=Boolean(i<=n.default.tabletLarge),c=Boolean(i>n.default.tabletLarge),u=Boolean(i<=n.default.desktopSmallMedium);t.set("isViewportMobile",o),t.set("isViewportMobileLarge",s),t.set("isViewportTablet",a),t.set("isViewportTabletLarge",r),t.set("isViewportDesktop",c),t.set("isViewportDesktopSmallMedium",u);var d=c||r||a,f=r||a||s||o;t.set("isViewportDesktopTablet",d),t.set("isViewportTabletMobile",f,!0)};var n=s(i(107)),o=s(i(3));function s(e){return e&&e.__esModule?e:{default:e}}},75:function(e,t,i){"use strict";var n=p(i(5)),o=p(i(3)),s=p(i(20)),a=p(i(2)),r=p(i(17)),c=p(i(176)),u=p(i(60)),d=p(i(41)),f=p(i(10)),l=p(i(103)),g=p(i(177)),h=i(72);function p(e){return e&&e.__esModule?e:{default:e}}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reference=f.default.generateUUID(),this.config=a.default.setReference(this.reference,a.default.init(t)),this.events=r.default.getInstance(this.reference),this.listenToWindowResize=!1,this.opts={},this.resizeTimeout=null}var t,i,p;return t=e,(i=[{key:"attachMountConfig",value:function(e){this.config.set("isModeProduct",e.isModeProduct),this.config.set("isModeService",e.isModeService),this.config.set("isTypeCarousel",e.isTypeCarousel),this.config.set("isTypeFacebook",e.isTypeFacebook),this.config.set("isTypeFloating",e.isTypeFloating),this.config.set("isTypeLightbox",e.isTypeLightbox),this.config.set("isTypeMediaIntegration",e.isTypeMediaIntegration),this.config.set("isTypeOnpage",e.isTypeOnpage),this.config.set("mountMode",e.mountMode),this.config.set("mountReference",e.mountReference),this.config.set("showReplies",e.showReplies,!0),this.config.set("showTopics",e.showTopics),this.config.set("showSnippets",e.showSnippets),this.config.set("schemaId",e.schemaId)}},{key:"buildReviewsOptions",value:function(e){(e="object"===v(e)&&null!==e?e:{}).pagination="object"===v(e.pagination)?e.pagination:{},this.opts.pagination="object"===v(this.opts.pagination)?this.opts.pagination:{};var t=s.default.resolve(),i={filtering:e.filtering||this.opts.filtering||t.DEFAULT_FILTERING,isPaging:e.isPaging||this.opts.isPaging,pagination:{currentPage:e.pagination.currentPage||this.opts.pagination.currentPage||t.DEFAULT_PAGE_NUMBER,pageSize:e.pagination.pageSize||this.opts.pagination.pageSize||t.DEFAULT_PAGE_SIZE},selectedFeature:e.selectedFeature,sorting:e.sorting||this.opts.sorting||t.DEFAULT_SORTING,summary:e.summary||this.opts.summary||null};return this.opts=i,i}},{key:"detachEvents",value:function(){this.listenToWindowResize&&((0,n.default)(window).off("resize."+this.reference,this.onWindowResize.bind(this)),this.listenToWindowResize=!1)}},{key:"fetchMedia",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.default.noop,n=this.fetchMediaPrepare(e);n.fetchGallery({pageNumber:0,pageSize:100}).then(function(){t.events.broadcast("updated-media",n),i()})}},{key:"fetchMediaPrepare",value:function(e){var t=new l.default(function(){return e.config});return this.events.broadcast("update-media",t),t}},{key:"fetchReviews",value:function(e,t){var i,n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.default.noop,s=this.buildReviewsOptions(t),a={page:s.pagination.currentPage,page_size:s.pagination.pageSize,since_period:c.default.getSincePeriod(e.config),full_thread:e.config.showReplies?"include":"exclude",unanswered_feedback:e.config.displayOnlyAnsweredReviews?"exclude":"include",source:e.config.mountReference};s.selectedFeature&&(a.selected_feature=s.selectedFeature),c.default.setFiltering(s.filtering,a),c.default.setSorting(s.sorting,a,e.config.displayImportedReviews),e.config.isModeService?i=e.config.displayImportedReviews&&!e.config.isTypeCarousel?"fetchServiceImported":"fetchService":e.config.isModeProduct&&(i=e.config.displayImportedReviews&&!e.config.isTypeCarousel?"fetchProductImported":"fetchProduct"),this.events.broadcast("update-reviews"),g.default.fetchDetailed[i](a,function(t,i){if(t)return console.error(t);if("object"===v(i.data)){var a=e.config.isTypeFacebook?"feedbacksItemsDistinct":"feedbacksItems";n.events.broadcast("updated-reviews",{pagination:{currentPage:i.data.summary.meta.current_page,noPages:i.data.summary.meta.pages},reviews:u.default[a](e.config,i.data.reviews,s.summary),isPaging:s.isPaging,reviewCount:i.data.summary.meta.count,importedReviewsCount:i.data.summary.meta.imported_count,verifiedReviewsCount:i.data.summary.meta.verified_count}),o(i.data)}})}},{key:"fetchReviewsCarousel",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.default.noop;if(!e.config.isTypeCarousel)return n();var o,s=this.buildReviewsOptions(t),a={page:1,page_size:20,since_period:c.default.getSincePeriod(e.config),full_thread:e.config.showReplies?"include":"exclude",unanswered_feedback:e.config.displayOnlyAnsweredReviews?"exclude":"include"};c.default.setSorting(a,s.sorting),e.config.preferences.serviceCarouselWidget.ratings&&(a.rating=e.config.preferences.serviceCarouselWidget.ratings.toString()),e.config.isModeService?o="fetchService":e.config.isModeProduct&&(o="fetchProduct"),this.events.broadcast("update-carousel-reviews"),g.default.fetchDetailed[o](a,function(t,o){if(t)return console.error(t);"object"===v(o.data)&&(i.events.broadcast("updated-carousel-reviews",{reviews:u.default.feedbacksItems(e.config,o.data.reviews,s.summary),isPaging:s.isPaging}),n(o.data))})}},{key:"fetchSummary",value:function(e,t){var i,n,o=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.default.noop,a=this.buildReviewsOptions(t),r={since_period:c.default.getSincePeriod(e.config),unanswered_feedback:e.config.displayOnlyAnsweredReviews?"exclude":"include",source:e.config.mountReference};c.default.setFiltering(a.filtering,r),e.config.isModeService?i=e.config.displayImportedReviews&&!e.config.isTypeCarousel?"fetchServiceImported":"fetchService":e.config.isModeProduct&&(i=e.config.displayImportedReviews&&!e.config.isTypeCarousel?"fetchProductImported":"fetchProduct"),e.config.isModeProduct&&this.events.broadcast("update-attributes"),n=e.config.isTypeFacebook&&e.config.isModeProduct?"summary-product":e.config.isTypeFacebook&&e.config.isModeService?"summary-service":"summary",this.events.broadcast("update-"+n),g.default.fetchSummary[i](r,function(t,i){if(t)return console.error(t);"object"===v(i.data)&&(o._updateSummary(e,i.data,n),s(i.data))})}},{key:"setSummary",value:function(e){var t=e.opts&&e.opts.mountConfig&&e.opts.mountConfig.data;this._updateSummary(e,t)}},{key:"fetchTranslations",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.default.noop;d.default.fetchTranslations(function(i){o.default.setConfig("translations",i),e.config.set("translations",i,!0),t()},this.config)}},{key:"listenForWindowResize",value:function(){this.listenToWindowResize=!0,this.setDisplayConfig(),(0,n.default)(window).on("resize."+this.reference,this.onWindowResize.bind(this))}},{key:"onWindowResize",value:function(e){e="boolean"==typeof e&&e,clearTimeout(this.resizeTimeout),e?this.setDisplayConfig():this.resizeTimeout=setTimeout(this.setDisplayConfig.bind(this),250)}},{key:"selectDefaultTab",value:function(e){"service"===e||"both"===e?this.selectTab("service",!0):"product"===e&&this.selectTab("product",!0)}},{key:"selectTab",value:function(e,t){this.config.set("isModeProduct","product"===e),this.config.set("isModeService","service"===e,!0),t||this.events.broadcast("selected-tab",e)}},{key:"setDisplayConfig",value:function(){(0,h.setViewportData)(window,this.config)}},{key:"_updateSummary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"summary";e.config.isModeProduct&&this.events.broadcast("updated-attributes",u.default.productAttributeItems(e.config,t.rating.product.attributes)),this.config.set("merchantLogo",t.merchant.logo),this.config.set("merchantName",t.merchant.name),this.config.set("merchantReviewUrl",t.merchant.review_url),this.config.set("merchantUrl",t.merchant.url,!0),this.opts.summary=t,this.events.broadcast("updated-"+i,u.default.merchantHeader(e.config,t)),this.events.broadcast("fetched-widget-data",{averageRating:t.rating.rating,reviewCount:t.meta.count})}}])&&m(t.prototype,i),p&&m(t,p),e}();e.exports=w}}]);